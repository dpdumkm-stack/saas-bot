<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Langganan Tidak Aktif - {{ toko.nama if toko else 'Dashboard' }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="max-w-2xl w-full">
        <!-- Main Card -->
        <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
            <!-- Header with Status Badge -->
            <div class="bg-gradient-to-r from-red-500 to-orange-500 p-8 text-white text-center">
                <div class="flex justify-center mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                </div>
                <h1 class="text-3xl font-bold mb-2">‚ö†Ô∏è Langganan Tidak Aktif</h1>
                <p class="text-red-100 text-lg">Dashboard tidak dapat diakses</p>
            </div>

            <!-- Content -->
            <div class="p-8">
                <!-- Status Badge -->
                <div class="flex justify-center mb-6">
                    {% if subscription and subscription.status == 'CANCELLED' %}
                    <span
                        class="bg-orange-100 text-orange-800 px-4 py-2 rounded-full font-semibold text-sm border-2 border-orange-300">
                        üî¥ Status: Dibatalkan
                    </span>
                    {% elif subscription and subscription.status == 'EXPIRED' %}
                    <span
                        class="bg-red-100 text-red-800 px-4 py-2 rounded-full font-semibold text-sm border-2 border-red-300">
                        ‚è∞ Status: Kadaluarsa
                    </span>
                    {% else %}
                    <span
                        class="bg-gray-100 text-gray-800 px-4 py-2 rounded-full font-semibold text-sm border-2 border-gray-300">
                        ‚ùå Status: Tidak Aktif
                    </span>
                    {% endif %}
                </div>

                <!-- Toko Info -->
                {% if toko %}
                <div class="text-center mb-6">
                    <p class="text-gray-600 text-sm">Toko:</p>
                    <p class="text-2xl font-bold text-gray-800">{{ toko.nama }}</p>
                    <p class="text-gray-500 text-sm">{{ toko.id }}</p>
                </div>
                {% endif %}

                <!-- Message based on status -->
                {% if subscription and subscription.status == 'CANCELLED' %}
                {% if subscription.grace_period_ends %}
                <!-- Cancelled with Grace Period -->
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-6 mb-6 rounded-lg">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <svg class="h-6 w-6 text-yellow-600" xmlns="http://www.w3.org/2000/svg" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-semibold text-yellow-900 mb-2">üí° Kabar Baik!</h3>
                            <p class="text-yellow-800 mb-3">
                                Anda membatalkan langganan pada <strong>{{ subscription.cancelled_at.strftime('%d %b
                                    %Y') }}</strong>.
                            </p>
                            <p class="text-yellow-800 mb-3">
                                Data Anda masih tersimpan sampai:
                            </p>
                            <p class="text-2xl font-bold text-yellow-900 mb-3">
                                üìÖ {{ subscription.grace_period_ends.strftime('%d %b %Y') }}
                            </p>
                            <p class="text-yellow-700 text-sm">
                                Anda masih bisa reaktivasi tanpa kehilangan data!
                            </p>
                        </div>
                    </div>
                </div>
                {% else %}
                <!-- Cancelled without Grace Period (permanent) -->
                <div class="bg-red-50 border-l-4 border-red-400 p-6 mb-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-red-900 mb-2">üò¢ Langganan Dibatalkan</h3>
                    <p class="text-red-800 mb-2">
                        Masa grace period (30 hari) telah berakhir.
                    </p>
                    <p class="text-red-700">
                        Data Anda sudah dihapus dari sistem. Silakan daftar ulang untuk menggunakan layanan kembali.
                    </p>
                </div>
                {% endif %}
                {% elif subscription and subscription.status == 'EXPIRED' %}
                <!-- Expired Subscription -->
                <div class="bg-red-50 border-l-4 border-red-400 p-6 mb-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-red-900 mb-2">‚è∞ Langganan Kadaluarsa</h3>
                    <p class="text-red-800 mb-2">
                        Masa aktif berakhir pada: <strong>{{ subscription.expired_at.strftime('%d %b %Y') if
                            subscription.expired_at else 'N/A' }}</strong>
                    </p>
                    <p class="text-red-700">
                        Bot Anda sudah berhenti merespons customer. Perpanjang sekarang untuk mengaktifkan kembali!
                    </p>
                </div>
                {% else %}
                <!-- Unknown status -->
                <div class="bg-gray-50 border-l-4 border-gray-400 p-6 mb-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">‚ùå Akses Ditolak</h3>
                    <p class="text-gray-700">
                        Subscription Anda tidak aktif. Silakan hubungi support untuk informasi lebih lanjut.
                    </p>
                </div>
                {% endif %}

                <!-- CTA Buttons -->
                <div class="space-y-4">
                    {% if subscription and subscription.status == 'CANCELLED' and subscription.grace_period_ends %}
                    <!-- Reactivate Button (Grace Period Active) -->
                    <button onclick="reactivateNow()"
                        class="w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition-all transform hover:scale-105">
                        üîÑ Reaktivasi Gratis Sekarang
                    </button>
                    {% else %}
                    <!-- Renew/Resubscribe Button -->
                    <a href="https://saas-bot-643221888510.asia-southeast2.run.app/"
                        class="block w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition-all transform hover:scale-105 text-center">
                        üöÄ Perpanjang / Daftar Ulang
                    </a>
                    {% endif %}

                    <!-- Support Button -->
                    <a href="https://wa.me/6281219400496?text=Halo,%20saya%20butuh%20bantuan%20dengan%20subscription"
                        class="block w-full bg-white hover:bg-gray-50 text-gray-700 font-semibold py-3 px-6 rounded-xl border-2 border-gray-300 transition-all text-center">
                        üí¨ Hubungi Support
                    </a>

                    <!-- Logout Button -->
                    <a href="/dashboard/logout"
                        class="block w-full bg-gray-100 hover:bg-gray-200 text-gray-600 font-medium py-3 px-6 rounded-xl transition-all text-center">
                        üö™ Logout
                    </a>
                </div>
            </div>

            <!-- Footer -->
            <div class="bg-gray-50 px-8 py-4 border-t border-gray-200">
                <p class="text-center text-sm text-gray-600">
                    Ada pertanyaan? <a href="https://wa.me/6281219400496"
                        class="text-blue-600 hover:text-blue-800 font-semibold">Chat kami di WhatsApp</a>
                </p>
            </div>
        </div>
    </div>

    <script>
        window.TOKO_ID = "{{ toko.id if toko else '' }}";
    </script>
    <script src="{{ url_for('static', filename='js/subscription_inactive.js') }}"></script>
</body>

</html>